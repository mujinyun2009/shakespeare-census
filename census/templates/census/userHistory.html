{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="wrapper">

<ul>
<li><a class="not.active" href="{% url 'homepage' %}"><p class="sansserif">
Home</p></a></li>
<li><a class="not.active" href="{% url 'index' %}"><p class="sansserif">
Titles</p></a></li>
<li><a class="not.active" href="{% url 'copylist' %}"><p class="sansserif">
Copy</p></a></li>
<li>
    <a class="not.active" href="{% url 'submission' %}" class="dropbtn"><p class="sansserif">Submission</p></a>
</li>
{% if user.is_authenticated %}
  {% else %}
<li><a class="not.active" href="{% url 'register' %}"><p class="sansserif">
Register</p></a></li>
   {% endif %}

<li class="dropdown">
<a href="" class="dropbtn" data-toggle="dropdown" role="button" aria-expanded="false">  <p class = sansserif>
Account</p></a>
<div class="dropdown-content">
  <a href="{% url 'profile' %}"><p class = sansserif>my profile</p></a>
  <a href="{% url 'user_history' %}" class="active2"><p class = sansserif>my history</p></a>
 {% if user.is_authenticated %}
<a href="{% url 'logout_user' %}"><p class = sansserif>logout</p></a>
  {% else %}
  <a href="{% url 'login_user' %}"><p class = sansserif>login</p></a>
   {% endif %}
</div>
</li>

</ul></div>

<style>

.layer
{
    position: fixed;
    opacity: 0.7;
    left: 0px;
    top: 0px;
    width: 100%;
    height: 100%;
    z-index: 999999;
    background-color: #BEBEBE;
    display: none;
    cursor: not-allowed;
}

</style>
<div class="layer" id="layer" style="display:none"></div>

<br>
<br>
<div class = "history">
Your contributions.</div>
<br>
<br>
<table align = "center">
	<tr>
		<th colspan=4>Copies you have submitted</th>
	</tr>
	{% if submissions %}

	{% for submission in submissions %}
		<tr>
			<td>{{ submission }}<td>
			<td><a href="{% url 'copy_detail' submission.id %}" class="editbutton" role="button" onclick="return popup(this);">Details</a></td>
			<td><a href="{% url 'edit_copy_submission' submission.id %}" class="editbutton" role="button" onclick="return popup(this);">Edit</a></td>
		</tr>
	{% endfor %}
	{% else %}
		<tr>
			<td>None, so far! Click <a href="{% url 'submission' %}" class="editbutton" role="button">here</a> to submit some.<td>
		</tr>
	{% endif %}

</table>

<br>
<br>

<table align="center">
	<tr>
		<th colspan=4>Copies you have edited</th>
	</tr>
	{% if editted_copies %}
	{% for copy in editted_copies %}
		<tr>
			<td>{{ copy }}<td>
			<td><a href="{% url 'copy_detail' copy.id %}" class="editbutton" role="button" onfocus="parent_disable();" onclick="return popup(this);">Details</a></td>
			<td><a href="{% url 'edit_copy_submission' copy.id %}" class="editbutton" role="button" onclick="return popup(this);">Edit</a></td>
		</tr>
	{% endfor %}
	{% else %}
		<tr>
			<td>None, so far!<td>
		</tr>
	{% endif %}

</table>

<script>
var layer = document.getElementById('layer');
var new_win;

function popup(triggeringLink) {
  layer.style.display = "block";
  var href = triggeringLink.href;
  var name = triggeringLink.name;
  new_win = window.open(href, name, "height=800,width=1000,left=300,top=200,resizable=yes,scrollbars=yes");
  new_win.focus();
  if(!new_win.closed) {
    new_win.focus();
  }
  return false;
}

// function parent_disable() {
//   if(new_win && !new_win.closed) {
//     new_win.focus();
//   }
// }

$(document).ready(function(){
  $(".layer").click(function(e) {
    new_win.focus();
  });
});

</script>

{% endblock content %}

{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" type="text/css" href= "{% static 'census/index.css' %}" />

<div class="wrapper">

<ul>
<li><a class="not.active" href="{% url 'homepage' %}"><p class="sansserif">
Home</p></a></li>
<li><a class="not.active" href="{% url 'index' %}"><p class="sansserif">
Titles</p></a></li>
<li><a class="active" href="{% url 'copylist' %}"><p class="sansserif">
Copy</p></a></li>
<li>
    <a class="not.active" href="{% url 'submission' %}" class="dropbtn"><p class="sansserif">Submission</p></a>
</li>
{% if user.is_authenticated %}
  {% else %}
<li><a class="not.active" href="{% url 'register' %}"><p class="sansserif">
Register</p></a></li>
   {% endif %}

<li class="dropdown">
<a href="" data-toggle="dropdown" role="button" aria-expanded="false">  <p class = sansserif>
Account</p></a>
<div class="dropdown-content">
 {% if user.is_authenticated %}

  <a href="{% url 'profile' %}"><p class = sansserif>my profile</p></a>
  <a href="{% url 'user_history' %}"><p class = sansserif>my history</p></a>
<a href="{% url 'logout_user' %}"><p class = sansserif>logout</p></a>
  {% else %}
  <a href="{% url 'login_user' %}"><p class = sansserif>login</p></a>
   {% endif %}
</div>
</li>

</ul>


<hr class = "style14" width = "50%"></hr>
	<p class="sansserifgrey">
	See all entries in the database below.
	</p>
</div>
<hr class="style14" width = "50%"></hr>
<form method='GET' action=''>
<input type='text' name ='q' placeholder='refine' value ='{{ request.GET.q }}' class="refinesearch">
<br>
<br>

<input type='submit' value='search' class="finalsubmit"/>
</form>
{% if query %}
    <p class="sansserif">
      <table class = "center" align="center" width="100%">
        <tr>
          <th> Title </th>
                <th> Edition </th>
          <th> NSC </th>
                <th> Owner </th>
                <th> Height </th>
                <th> Width </th>
                <th> Condition </th>
                <th> Binding </th>
                <th> Transactions </th>
        </tr>
        <tr>
        {% for obj in object_list %}
          <td>{{ obj.issue.edition.title }}</td>
                <td>{{ obj.issue.edition.Edition_number }}</td>
                <td>{{ obj.NSC }}</td>
                <td>{{ obj.Owner }}</td>
                <td>{{ obj.Height }}</td>
                <td>{{ obj.Width }}</td>
                <td>{{ obj.Condition }}</td>
                <td>{{ obj.Binding }}</td>
                <td><a href="{% url 'transactions' obj.id %}" class="linkbutton">Available transactions</a></td>

        </tr>

        {% endfor %}
        </table>
</p>
<div class="pagination">
    <table class = "pagenavigator" align="center">
    <tr class ="pagenavigator">
      {% if object_list.has_previous %}
      <td class = "hoverspecial"> <a href="?page={{ object_list.previous_page_number }}&q={{ request.GET.q }}" class="paginator"><</a></td>
      {% endif %}

    {% for page in object_list.paginator.page_range %}
      {% if page <= object_list.number|add:"3" %}
        {% if page >= object_list.number|add:"-3" %}
        {% if page == object_list.number %}
          <td class = "currentpage" width="20px">{{ page }}</td>
        {% else %}
          <td class="pagenavigator" width="20px"> <a href = "?page={{ page }}&q={{ request.GET.q }}" class="paginator">{{ page }}</td> 
        {% endif %}
        {% endif %}
      
      {% endif %}
    {% endfor %}

      {% if object_list.has_next %}
       <td class = "hoverspecial">  <a href="?page={{ object_list.next_page_number }}&q={{ request.GET.q }}" class="paginator">></a></td>
      {% endif %}
    </tr>
  </table>
  Pages generated: {{ object_list.paginator.num_pages }}
</div>

{% else %}
<br>
<br>
{% if copies %}
    <p class="sansserif">
    	<table class = "center" align="center" width="100%">
    		<tr>
    			<th> Title </th>
                <th> Edition </th>
    			<th> NSC </th>
                <th> Owner </th>
                <th> Height </th>
                <th> Width </th>
                <th> Condition </th>
                <th> Binding </th>
                <th> Transactions </th>
    		</tr>
    		<tr>
    		{% for copy in copies %}
   				<td>{{ copy.issue.edition.title }}</td>
                <td>{{ copy.issue.edition.Edition_number }}</td>
                <td>{{ copy.NSC }}</td>
                <td>{{ copy.Owner }}</td>
                <td>{{ copy.Height }}</td>
                <td>{{ copy.Width }}</td>
                <td>{{ copy.Condition }}</td>
                <td>{{ copy.Binding }}</td>
                <td><a href="{% url 'transactions' copy.id %}" class="linkbutton">Available transactions</a></td>

   			</tr>

        {% endfor %}
        </table>


    </p>

<div class="pagination">
    <table class = "pagenavigator" align="center">
    <tr class ="pagenavigator">
      {% if copies.has_previous %}
      <td class = "hoverspecial"> <a href="?page={{ copies.previous_page_number }}" class="paginator"><</a></td>
      {% endif %}

    {% for page in copies.paginator.page_range %}
      {% if page <= copies.number|add:"3" %}
        {% if page >= copies.number|add:"-3" %}
        {% if page == copies.number %}
          <td class = "currentpage" width="20px">{{ page }}</td>
        {% else %}
          <td class="pagenavigator" width="20px"> <a href = "?page={{ page }}" class="paginator">{{ page }}</td> 
        {% endif %}
        {% endif %}
      
      {% endif %}
    {% endfor %}

      {% if copies.has_next %}
       <td class = "hoverspecial">  <a href="?page={{ copies.next_page_number }}" class="paginator">></a></td>
      {% endif %}
    </tr>
  </table>
  Pages generated: {{ copies.paginator.num_pages }}
</div>
{% else %}
    <p class="sansserif" align="center">Oh no! No copies are available.</p>
{% endif %}
{% endif %}

{% endblock content %}

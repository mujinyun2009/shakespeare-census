{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" type="text/css" href= "{% static 'census/index.css' %}" />

<head>
<title>Shakespeare Census</title>
</head>
<div class="wrapper">

<ul>
<li><a class="not.active" href="{% url 'homepage' %}"><p class="sansserif">
Home</p></a></li>
<li><a class="not.active" href="{% url 'index' %}"><p class="sansserif">
Titles</p></a></li>
<li><a class="not.active" href="{% url 'copylist' %}"><p class="sansserif">
Copy</p></a></li>
<li>
	<a class="not.active" href="{% url 'submission' %}" class="dropbtn"><p class="sansserif">Submission</p></a>
</li>
{% if user.is_authenticated %}
  {% else %}
<li><a class="not.active" href="{% url 'register' %}"><p class="sansserif">
Register</p></a></li>
   {% endif %}
<li class="dropdown">
<a href="" data-toggle="dropdown" role="button" aria-expanded="false">  <p class = sansserif>
Account</p></a>
<div class="dropdown-content">
 {% if user.is_authenticated %}

  <a href="{% url 'profile' %}"><p class = sansserif>my profile</p></a>
  <a href="{% url 'user_history' %}"><p class = sansserif>my history</p></a>
	<a href="{% url 'logout_user' %}"><p class = sansserif>logout</p></a>
  {% else %}
  <a href="{% url 'login_user' %}"><p class = sansserif>login</p></a>
   {% endif %}
</div>
</li>

</ul>

{%if result_list%}
<hr class="style14" width = "50%"></hr>
	<p class="sansserifgrey">
	Find searches below.
	</p>
</div>
<hr class = "style14" width = "50%"></hr>

</br>
<center>
<table class = "center" align="center">
<th colspan="8">Books found:</th>
<tr>
<td class="subhead">Title</td>
<td class="subhead">Year Published</td>
<td class="subhead">Edition Number</td>
<td class="subhead">ESTC</td>
<td class="subhead">STC/Wing</td>
<td class="subhead">Owner</td>
<td class="subhead"></td>
<td class="subhead"></td>
</tr>
<tr>
{% for obj in result_list %}
<td>{{ obj.issue.edition.title}}</td>
<td>{{ obj.issue.year }}</td>
<td>{{ obj.issue.edition.Edition_number}}</td>
<td>{{ obj.issue.ESTC }}</td>
<td>{{ obj.issue.STC_Wing }}</td>
<td>{{ obj.Owner }}</td>
<td><a href="{% url 'copy_detail' obj.id %}" class="resultbuttons" onclick="return popup(this);">Detail</a></td>
<td><a href="{% url 'edit_copy_submission' obj.id %}" class="resultbuttons" role="button" onclick="return popup(this);">Edit</a></td>
</tr>
{% endfor %}
</table>
<br>

<div class="pagination">
	  <table class = "pagenavigator" align="center">
		<tr class ="pagenavigator">
			{% if result_list.has_previous %}
			<td class = "hoverspecial"> <a href="?a={{ query1 }}&b={{ query2 }}&c={{ query3 }}&d={{ query4 }}&j={{ category1 }}&k={{ category2 }}&l={{ category3 }}&z={{ category4 }}&page={{ result_list.previous_page_number }}"><</a></td>
			{% endif %}

		{% for page in result_list.paginator.page_range %}
			{% if page <= result_list.number|add:"3" %}
				{% if page >= result_list.number|add:"-3" %}
				{% if page == result_list.number %}
					<td class = "currentpage" width="20px">{{ page }}</td>
				{% else %}
					<td class="pagenavigator" width="20px"> <a href = "?a={{ query1 }}&b={{ query2 }}&c={{ query3 }}&d={{ query4 }}&j={{ category1 }}&k={{ category2 }}&l={{ category3 }}&z={{ category4 }}&page={{ page }}"">{{ page }}</td> 
				{% endif %}
				{% endif %}
			
			{% endif %}
		{% endfor %}

			{% if result_list.has_next %}
			 <td class = "hoverspecial">	<a href="?a={{ query1 }}&b={{ query2 }}&c={{ query3 }}&d={{ query4 }}&j={{ category1 }}&k={{ category2 }}&l={{ category3 }}&z={{ category4 }}&page={{ result_list.next_page_number }}">></a></td>
			{% endif %}
		</tr>
	</table>
	Pages generated: {{ result_list.paginator.num_pages }}
</div>
<br>
<br>
{%else%}
<hr class="style14" width = "50%"></hr>
	<p class="sansserifgrey">
	No matches were found.<br> Did you misspell your query?
	</p>
<hr class="style14" width = "50%"></hr>
</div>
{% endif %}
</center>

<script>
function popup(triggeringLink) {
	var href = triggeringLink.href;
	var name = triggeringLink.name;
	var win = window.open(href, name, "height=800,width=1000,resizable=yes,scrollbars=yes");
	win.focus();
	return false;
}
</script>
{% endblock content %}
